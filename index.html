<!doctype html>
<html lang="ru">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>CrossDaunBot Statistics</title>
        <link rel="stylesheet" href="./preflight.css" />
        <link rel="stylesheet" href="./style.css" />
    </head>
    <body>
        <div class="container">
            <div class="header-section">
                <div class="header-text">
                    <h2 class="font-32">
                        CrossDaun
                        <span class="text-sky">Users</span>
                    </h2>
                    <p class="text-grey">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∑–∞–≤–æ–¥—á–∞–Ω</p>
                </div>
                <input
                    type="text"
                    id="searchInput"
                    class="search-box"
                    placeholder="–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è..." />
            </div>
        </div>
        <div class="cards-and-switcher">
            <div class="switcher-box not-in-mobile">
                <button id="alltime" class="switcher active">
                    –ó–∞ –≤—Å–µ –≤—Ä–µ–º—è
                </button>
                <button id="allmonth" class="switcher">–ó–∞ –º–µ—Å—è—Ü</button>
            </div>
            <div class="cards">
                <div class="table-header not-in-mobile grid-row">
                    <div>
                        <span class="text-sky white-born">ID</span>
                    </div>
                    <div>
                        <span class="text-sky">–§–æ—Ç–æ</span>
                    </div>
                    <div>
                        <span class="text-sky white-born">–ò–º—è</span>
                    </div>
                    <div class="align-center">
                        <span class="text-sky white-born">–°–æ–æ–±—â–µ–Ω–∏–π</span>
                    </div>
                    <div class="align-center">
                        <span class="text-sky white-born">–ú–µ–¥–∏–∞</span>
                    </div>
                    <div class="align-center">
                        <span class="text-sky white-born">–°—Ç–∏–∫–µ—Ä–æ–≤</span>
                    </div>
                    <div class="align-center">
                        <span class="text-sky white-born">nya</span>
                    </div>
                </div>
                <div class="card grid-row">
                    <span>#1</span>
                    <img class="avatar" src="/koti.jpg" />
                    <span class="user-name text-blue">@piscopancer</span>
                    <div class="align-center">
                        <div class="split-box">
                            <span>üí¨ 3</span>
                        </div>
                    </div>
                    <div class="align-center">
                        <div class="split-box">
                            <span class="split-val">üñºÔ∏è 333</span>
                            <div class="seperator"></div>
                            <span class="split-val">üé• 33</span>
                        </div>
                    </div>
                    <div class="align-center">
                        <div class="split-box">
                            <span>üí† 3</span>
                        </div>
                    </div>
                    <div class="align-center">
                        <div class="split-box">
                            <span>üê± 333</span>
                        </div>
                    </div>
                </div>
                <div class="card grid-row">
                    <span>#1</span>
                    <img class="avatar" src="/koti.jpg" />
                    <span class="user-name text-blue">@Username1</span>
                    <div class="align-center">
                        <div class="split-box">
                            <span>üí¨ 222</span>
                        </div>
                    </div>
                    <div class="align-center">
                        <div class="split-box">
                            <span class="split-val">üñºÔ∏è 11</span>
                            <div class="seperator"></div>
                            <span class="split-val">üé• 11</span>
                        </div>
                    </div>
                    <div class="align-center">
                        <div class="split-box">
                            <span>üí† 333</span>
                        </div>
                    </div>
                    <div class="align-center">
                        <div class="split-box">
                            <span>üê± 33</span>
                        </div>
                    </div>
                </div>
                <div class="card grid-row">
                    <span>#1</span>
                    <img class="avatar" src="/koti.jpg" />
                    <span class="user-name text-blue">@Username1</span>
                    <div class="align-center">
                        <div class="split-box">
                            <span>üí¨ 1</span>
                        </div>
                    </div>
                    <div class="align-center">
                        <div class="split-box">
                            <span class="split-val">üñºÔ∏è 100</span>
                            <div class="seperator"></div>
                            <span class="split-val">üé• 100</span>
                        </div>
                    </div>
                    <div class="align-center">
                        <div class="split-box">
                            <span>üí† 20</span>
                        </div>
                    </div>
                    <div class="align-center">
                        <div class="split-box">
                            <span>üê± 3</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script>
            // –ü–æ–∏—Å–∫ (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è)
            document
                .getElementById("searchInput")
                .addEventListener("input", function () {
                    const filter = this.value.toLowerCase();
                    const rows = document.querySelectorAll("#cards .card");
                    rows.forEach((row) => {
                        row.style.display = row.innerText
                            .toLowerCase()
                            .includes(filter)
                            ? ""
                            : "none";
                    });
                });

            // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
            function sortTable(columnIndex) {
                console.log("function called for column:", columnIndex);
                const table = document.getElementById("usersTable");
                const tbody = document.getElementById("tableBody");
                const rows = Array.from(tbody.querySelectorAll("tr"));
                const th = table.querySelectorAll("th")[columnIndex];

                // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                const isAscending = !th.classList.contains("sort-asc");

                // –ß–∏—Å—Ç–∏–º —Å—Ç–∏–ª–∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
                table
                    .querySelectorAll("th")
                    .forEach((h) =>
                        h.classList.remove("sort-asc", "sort-desc"),
                    );
                th.classList.add(isAscending ? "sort-asc" : "sort-desc");

                rows.sort((a, b) => {
                    let valA = a.children[columnIndex].innerText.trim();
                    let valB = b.children[columnIndex].innerText.trim();

                    // –ï—Å–ª–∏ –∫–æ–ª–æ–Ω–∫–∞ –Ω–µ —Ç–µ–∫—Å—Ç–æ–≤–∞—è (–≤—Å–µ, –∫—Ä–æ–º–µ "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å" –ø–æ–¥ –∏–Ω–¥–µ–∫—Å–æ–º 2)
                    if (columnIndex !== 2) {
                        // –í—ã–¥–∏—Ä–∞–µ–º –≤—Å–µ —Ü–∏—Ñ—Ä—ã. –ï—Å–ª–∏ –≤ —è—á–µ–π–∫–µ "üñºÔ∏è 10 | üé• 5", –ø–æ–ª—É—á–∏—Ç—Å—è "105" –∏–ª–∏ "15"
                        // –î–ª—è –∫–æ–ª–æ–Ω–æ–∫ —Å –æ–¥–Ω–∏–º —á–∏—Å–ª–æ–º —ç—Ç–æ –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç "üí¨ 100" –≤ 100
                        valA = parseInt(valA.replace(/\D/g, "")) || 0;
                        valB = parseInt(valB.replace(/\D/g, "")) || 0;

                        console.log(valA, valB);
                        return isAscending ? valA - valB : valB - valA;
                    }

                    // –î–ª—è –∏–º–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—Å—Ç–∞–≤–ª—è–µ–º –æ–±—ã—á–Ω—É—é —Å—Ç—Ä–æ–∫—É
                    return isAscending
                        ? valA.localeCompare(valB)
                        : valB.localeCompare(valA);
                });

                // –û—á–∏—â–∞–µ–º –∏ –∑–∞–∫–∏–¥—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω–æ
                tbody.innerHTML = "";
                rows.forEach((row) => tbody.appendChild(row));
            }
        </script>
    </body>
</html>
